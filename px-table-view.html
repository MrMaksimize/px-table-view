<link rel="import" href="../polymer/polymer.html"/>
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../iron-list/iron-list.html">
<link rel="import" href="../iron-selector/iron-selector.html">
<link rel="import" href="../iron-selector/iron-multi-selectable.html">
<link rel="import" href="px-table-view-behavior.html"/>
<link rel="import" href="px-table-view-sortable-behavior.html"/>
<link rel="import" href="px-table-view-pull-to-refresh-behavior.html"/>
<link rel="import" href="px-table-view-drilldown-behavior.html"/>
<link rel="import" href="px-table-row.html"/>
<!--
<p>
  For demo visit <a href="demo.html" target="_blank">Full demo here</a> or <a href="demo/mvp1-demo.html" target="_blank">Mobile demo here</a>
</p>
<p>
  For a list of all demos visit  <a href="./demo" target="_blank">here</a>.
</p>

## Usage

To style this component you can do the following:

```
:root {
  --table-view-border-color: red;
  --table-view-background-color: green;
}
```

To use this component with iron list you can do the following:
```
<div class="demo" style="height: 500px; overflow:auto;">
  <template id="tableViewTemplate" is="dom-bind">
    <iron-ajax url="./demo/data.json" last-response="{{data}}" auto></iron-ajax>
    <iron-list id="ironList" items="[[data]]" as="item" class="table-view  table-view--small">
      <template>
        <div class="table-row table-row--nav-right" on-click="handleSelect">
          <div class="table-row__media table-row__media--icon" hidden="{{!item.icon}}">
              <i class$="{{item.icon}}"></i>
          </div>
          <div class="table-row__media table-row__media--image" hidden="{{!item.image}}">
            <img src$="{{item.image}}" alt="{{item.title}}">
          </div>
          <div class="table-row__content">
            <span class="table-row__content__title">{{item.title}}</span>
          </div>
        </div>
      </template>
    </iron-list>
  </template>
  <script type="text/javascript">
    var tmpl = document.getElementById('tableViewTemplate');
    tmpl.handleSelect = function(e) {
      console.log('handleSelect', e);
    };
    document.addEventListener('WebComponentsReady', function() {
      setTimeout(function() {
        document.querySelector('iron-list').fire('iron-resize');
      }, 50);
    });
  </script>
</div>
```
@element px-table-view.html
@demo demo.html
@homepage index.html
-->
<dom-module id="px-table-view">
  <link rel="import" type="css" href="css/px-table-view.css">
  <style media="screen">
    :host {
      display: block;
      position: relative;

    }
    :host .table-view {
      @apply(--px-table-view);
    }
    :host ::content {
      @apply(--px-table-row);
    }

    :host .sortable-chosen,
    :host ::content .sortable-chosen{
        box-shadow: 0 2px 10px rgba(0,0,0,0.45);
    }

    :host .iron-selected {
      background-color: var(--px-table-row-selected-background-color, #0a9ec1);
      color: var(--px-table-row-selected-color, #fff);
    }

    .ptr__content{
      -webkit-transition: all .2s ease;
      transition: all .2s ease;
      will-change: transform;
    }

    :host {

    }
    :host.ptr-refresh {
      background: green;
    }

    :host.ptr-loading {
      background-color: purple !important;
    }
    :host.ptr-loading .ptr_loading{
      display:block;
    }

    :host.ptr-reset {
      background-color: crimson !important;
    }
  </style>
  <template strip-whitespace>

    <template is="dom-if" if="{{tableData}}">
      <template id="tableRowTemplate" items="{{tableData}}" is="dom-repeat">
        <px-table-row item="{{item}}"></px-table-row>
      </template>
    </template>

    <div id="ptr" class="ptr__loader" hidden$="{{!pullToRefresh}}">
      <div class="ptr__loading">
        <span id="l1"></span>
        <span id="l2"></span>
        <span id="l3"></span>
      </div>
    </div>

    <div id="content" class="table-view">
      <content id="content" select="px-table-row, [content]"></content>
    </div>

  </template>
  <script>
    Polymer({
      is: 'px-table-view',
      behaviors: [
        //Polymer.IronMultiSelectableBehavior,
        Polymer.IronResizableBehavior,
      //  pxTableViewSortableBehavior,
        pxTableViewBehavior,
        pxTableViewDrilldownBehavior,
        pxTableViewPullToRefreshBehavior
      ],
      properties: {
        //The list items data
        tableData: {
          type: Array
        },
        /**
         * The modifiers to apply to the table-view (small, large, huge, responsive)
         */
        modifier: {
          type: String,
          notify: true,
          reflectToAttribute: true,
          observer: '_handleModifier'
        },
        isSortable: {
          type: Boolean
        }
      },
      _handleModifier: function (newVal, oldVal) {
        var _this = this, klass, types;
        klass = 'table-view--' + oldVal;
        _this.toggleClass(klass, false, _this.$$('.table-view'));
        if (_this.modifier) {
          types = _this.modifier.split(' ');
          for (var i = 0; i < types.length; i++) {
            klass = 'table-view--' + types[i];
            _this.toggleClass(klass, true, _this.$$('.table-view'));
          }
        }
      }
    });
  </script>
</dom-module>
